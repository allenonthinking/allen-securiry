<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>登录</title>
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no">
	<link rel="stylesheet" href="${request.contextPath}/statics/plugins/layui/css/layui.css">
	<link rel="stylesheet" href="${request.contextPath}/statics/css/login1.css">
</head>
<body>
	<video class="video-player" preload="auto" autoplay="autoplay" loop="loop" data-height="1080" data-width="1920" height="1080" width="1920">
	    <source src="login.mp4" type="video/mp4">
	    <!-- 此视频文件为支付宝所有，在此仅供样式参考，如用到商业用途，请自行更换为其他视频或图片，否则造成的任何问题使用者本人承担，谢谢 -->
	</video>
	<div class="video_mask"></div>
	<div class="login">
	    <h1>登录</h1>
	    <form class="layui-form">
	    	<div class="layui-form-item">
				<input class="layui-input" name="username" placeholder="用户名" lay-verify="required" type="text" autocomplete="off" v-model="username">
		    </div>
		    <div class="layui-form-item">
				<input class="layui-input" name="password" placeholder="密码" lay-verify="required" type="password" autocomplete="off" v-model="password">
		    </div>
		    <div class="layui-form-item form_code">
				<input class="layui-input" name="code" placeholder="验证码" lay-verify="required" type="text" autocomplete="off"  v-model="captcha" @keyup.enter="login">
				<div class="code">
					<img alt="如果看不清楚，请单击图片刷新！" class="pointer" :src="src" @click="refreshCode">
        &nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:;" @click="refreshCode">点击刷新</a>
				</div>
		    </div>
			<button class="layui-btn login_btn" lay-submit="" lay-filter="login"  @click="login">登录</button>
		</form>
	</div>
	<script src="${request.contextPath}/statics/plugins/layui/layui.js"></script>
	<script src="${request.contextPath}/statics/libs/jquery.min.js"></script>
	<script src="${request.contextPath}/statics/libs/vue.min.js"></script>
	<script src="${request.contextPath}/statics/libs/bootstrap.min.js"></script>
	<script src="${request.contextPath}/statics/libs/jquery.slimscroll.min.js"></script>
	<script src="${request.contextPath}/statics/libs/fastclick.min.js"></script>
	<script src="${request.contextPath}/statics/libs/app.js"></script>
	<script type="text/javascript">
	var vm = new Vue({
		el:'#rrapp',
		data:{
			username: '',
			password: '',
			captcha: '',
			error: false,
			errorMsg: '',
			src: 'captcha.jpg'
		},
		beforeCreate: function(){
			if(self != top){
				top.location.href = self.location.href;
			}
		},
		methods: {
			refreshCode: function(){
				this.src = "captcha.jpg?t=" + $.now();
			},
			login: function (event) {
				var data = "username="+vm.username+"&password="+vm.password+"&captcha="+vm.captcha;
				$.ajax({
					type: "POST",
				    url: "sys/login",
				    data: data,
				    dataType: "json",
				    success: function(result){
						if(result.code == 0){//登录成功
							parent.location.href ='index.html';
						}else{
							vm.error = true;
							vm.errorMsg = result.msg;
							
							vm.refreshCode();
						}
					}
				});
			}
		}
	});
	
	layui.config({
		base : "js/"
	}).use(['form','layer'],function(){
		var form = layui.form(),
			layer = parent.layer === undefined ? layui.layer : parent.layer,
			$ = layui.jquery;
		//video背景
		$(window).resize(function(){
			if($(".video-player").width() > $(window).width()){
				$(".video-player").css({"height":$(window).height(),"width":"auto","left":-($(".video-player").width()-$(window).width())/2});
			}else{
				$(".video-player").css({"width":$(window).width(),"height":"auto","left":-($(".video-player").width()-$(window).width())/2});
			}
		}).resize();
	})	
	</script>	
</body>
</html>